# Secret heuristics scanning ALL string scalars via $..*
# Any match is flagged (using 'not_matches').

- id: SECRET-AWS-ACCESS-KEY
  severity: critical
  when: {}
  assert:
    - path: $..*
      not_matches: '\bAKIA[0-9A-Z]{16}\b'
  remediation: "Remove the AWS Access Key ID from source control and rotate it."

- id: SECRET-GITHUB-TOKEN
  severity: critical
  when: {}
  assert:
    - path: $..*
      not_matches: '\bghp_[A-Za-z0-9]{36}\b'
  remediation: "Remove the GitHub token and rotate it. Use repo/org secrets."

- id: SECRET-SLACK-BOT-TOKEN
  severity: high
  when: {}
  assert:
    - path: $..*
      not_matches: '\bxoxb-[0-9]{10,}-[0-9]{10,}-[A-Za-z0-9]{24,}\b'
  remediation: "Remove Slack token and regenerate. Store as a secret."

- id: SECRET-PEM-PRIVATE-KEY
  severity: critical
  when: {}
  assert:
    - path: $..*
      not_matches: '-----BEGIN (?:RSA |EC )?PRIVATE KEY-----'
  remediation: "Never commit private keys. Remove and rotate."

- id: SECRET-GCP-JSON-PRIVATE-KEY
  severity: critical
  when: {}
  assert:
    - path: $.private_key
      not_matches: '-----BEGIN PRIVATE KEY-----'
  remediation: "Do not commit GCP SA keys. Use workload identity or a secret store."
